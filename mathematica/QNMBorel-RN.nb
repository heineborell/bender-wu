(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17044,        440]
NotebookOptionsPosition[     15759,        408]
NotebookOutlinePosition[     16151,        424]
CellTagsIndexPosition[     16108,        421]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
This is a short program to compute QNMs of the Reisnner-Nordstroem BH by \
using the Borel summation technique\
\>", "Section",
 CellChangeTimes->{{3.769651986175993*^9, 3.769652021355834*^9}, {
  3.769652074220603*^9, 3.769652094471121*^9}, {3.769652568363598*^9, 
  3.769652578726256*^9}, {3.769663092953162*^9, 3.7696631182205133`*^9}, {
  3.7696642275711823`*^9, 3.76966423878771*^9}, {3.769666359115369*^9, 
  3.769666361702236*^9}, {3.76990421195863*^9, 3.7699042158840446`*^9}, {
  3.7792474717795343`*^9, 
  3.779247472123795*^9}},ExpressionUUID->"1d09d4ab-63f6-49bb-8694-\
8b41c66f29ba"],

Cell[CellGroupData[{

Cell["\<\
Before running it, you need to install the BenderWu package provided by \
Sulejmanpasic and Unsal in arXiv:1608.08256.
See section 4 in that paper to do so. \
\>", "Subsection",
 CellChangeTimes->{{3.769652112178843*^9, 3.769652176991346*^9}, {
   3.769652255704172*^9, 3.769652314130911*^9}, {3.769654852179462*^9, 
   3.7696548934457197`*^9}, {3.7696622081233797`*^9, 3.769662209889554*^9}, 
   3.769904226358019*^9},ExpressionUUID->"bae8d14f-457c-44ba-9f83-\
bae1d4d2bca3"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<BenderWu`\>\"", "]"}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"3ea2f44f-ecde-4f00-bb7a-abc89e760b29"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The following is the code that I used to compute QNMs.
You can easily change the potential part in the program, as you want.\
\>", "Subsection",
 CellChangeTimes->{{3.7696535994241343`*^9, 3.769653666892205*^9}, 
   3.769654843662973*^9, {3.769655153505403*^9, 3.769655189281268*^9}, {
   3.769655450365258*^9, 3.769655475699522*^9}, {3.769655674908359*^9, 
   3.7696556846050673`*^9}, {3.769662235765381*^9, 3.769662246440827*^9}, {
   3.769663105507223*^9, 3.7696631145305843`*^9}, 3.769904238778606*^9, {
   3.77924748539962*^9, 
   3.7792474862539787`*^9}},ExpressionUUID->"cf5ff56b-470c-499d-b612-\
7be9f7b44e5b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "QNM", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QNM", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Q_", ",", "l_", ",", "n_"}], "}"}], ",", "order_", ",", 
    "prec_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"QNM", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Q", ",", "l", ",", "n"}], "}"}], ",", "order", ",", "prec"}], 
    "]"}], "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$MaxExtraPrecision", "=", 
        RowBox[{"2", "prec"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"$MinPrecision", "=", "prec"}], ",", "V", ",", "rs", ",", "r0",
        ",", "del", ",", "Vexpand", ",", "v", ",", "BW", ",", 
       "\[Epsilon]pert", ",", "BT", ",", "\[Epsilon]Borel", ",", "\[Omega]", ",",
        "q1", ",", "rp", ",", "rm"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rp", "=", 
       FractionBox[
        RowBox[{"1", "+", 
         SqrtBox[
          RowBox[{"1", "-", 
           RowBox[{"4", 
            SuperscriptBox["Q", "2"]}]}]]}], "2"]}], ";", 
      RowBox[{"rm", "=", 
       FractionBox[
        RowBox[{"1", "-", 
         SqrtBox[
          RowBox[{"1", "-", 
           RowBox[{"4", 
            SuperscriptBox["Q", "2"]}]}]]}], "2"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "r_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Q", "\[Equal]", 
          FractionBox["1", "2"]}], ",", 
         RowBox[{"r", "-", 
          FractionBox["1", 
           RowBox[{"2", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "r"}], "-", "1"}], ")"}]}]], "+", 
          RowBox[{"Log", "[", 
           RowBox[{"r", "-", 
            FractionBox["1", "2"]}], "]"}]}], ",", 
         RowBox[{"r", "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"rp", "-", "rm"}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["rp", "2"], 
              RowBox[{"Log", "[", 
               RowBox[{"r", "-", "rp"}], "]"}]}], "-", 
             RowBox[{
              SuperscriptBox["rm", "2"], 
              RowBox[{"Log", "[", 
               RowBox[{"r", "-", "rm"}], "]"}]}]}], ")"}]}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          SqrtBox[
           RowBox[{"9", "+", 
            RowBox[{"16", 
             SuperscriptBox["Q", "2"], 
             RowBox[{"(", 
              RowBox[{"l", "-", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"l", "+", "2"}], ")"}]}]}]]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"V", "[", "r_", "]"}], "=", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["r", "2"]], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["1", "r"], "+", 
          FractionBox[
           SuperscriptBox["Q", "2"], 
           SuperscriptBox["r", "2"]]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l", 
           RowBox[{"(", 
            RowBox[{"l", "+", "1"}], ")"}]}], "-", 
          FractionBox["q1", "r"], "+", 
          FractionBox[
           RowBox[{"4", 
            SuperscriptBox["Q", "2"]}], 
           SuperscriptBox["r", "2"]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r0", "=", 
       RowBox[{"r", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"V", "'"}], "[", "r", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1.6"}], "}"}], ",", 
          RowBox[{"WorkingPrecision", "\[Rule]", "prec"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"del", "=", 
       RowBox[{
        RowBox[{"InverseSeries", "[", 
         RowBox[{
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"rs", "[", 
              RowBox[{"r0", "+", "\[Delta]"}], "]"}], "-", 
             RowBox[{"rs", "[", "r0", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Delta]", ",", "0", ",", 
              RowBox[{
               RowBox[{"2", "order"}], "+", "2"}]}], "}"}]}], "]"}], ",", 
          "\[Delta]s"}], "]"}], "//", "Normal"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Vexpand", "=", 
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"V", "[", 
            RowBox[{"r0", "+", "del"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Delta]s", ",", "0", ",", 
            RowBox[{
             RowBox[{"2", "order"}], "+", "2"}]}], "}"}]}], "]"}], "//", 
        "Normal"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", "[", "k_", "]"}], ":=", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"Vexpand", ",", "\[Delta]s", ",", "k"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"BW", "=", 
       RowBox[{"BenderWu", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"v", "[", "k", "]"}], 
             SuperscriptBox["x", "k"]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "2", ",", 
              RowBox[{
               RowBox[{"2", "order"}], "+", "2"}]}], "}"}]}], "]"}]}], ",", 
         "x", ",", "n", ",", "order"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Epsilon]pert", "=", 
       RowBox[{"BWProcess", "[", 
        RowBox[{"BW", ",", 
         RowBox[{"OutputStyle", "\[Rule]", "\"\<Series\>\""}], ",", 
         RowBox[{"Coupling", "\[Rule]", 
          RowBox[{"Sqrt", "[", "\[HBar]", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"BT", "[", 
        RowBox[{"\[Zeta]_", ",", "Padeorder_"}], "]"}], ":=", 
       RowBox[{"PadeApproximant", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"Coefficient", "[", 
              RowBox[{"\[Epsilon]pert", ",", "\[HBar]", ",", "k"}], "]"}], 
             RowBox[{"k", "!"}]], 
            SuperscriptBox["\[Zeta]", "k"]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", "order"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Zeta]", ",", "0", ",", "Padeorder"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Epsilon]Borel", "[", "Padeorder_", "]"}], ":=", 
       RowBox[{
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", "t"}], "]"}], 
            RowBox[{"BT", "[", 
             RowBox[{"\[Zeta]", ",", "Padeorder"}], "]"}]}], "/.", 
           RowBox[{"\[Zeta]", "\[Rule]", 
            RowBox[{"I", " ", "t"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
          RowBox[{"WorkingPrecision", "\[Rule]", "prec"}], ",", 
          RowBox[{"MaxRecursion", "\[Rule]", "50"}]}], "]"}], "//", 
        "Quiet"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Omega]", "[", "Padeorder_", "]"}], ":=", 
       SqrtBox[
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", "0", "]"}], "+", 
           RowBox[{"2", "I", " ", 
            RowBox[{"\[Epsilon]Borel", "[", "Padeorder", "]"}]}]}], 
          ")"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Omega]", "[", 
         RowBox[{"order", "/", "2"}], "]"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"\[Omega]", "[", 
           RowBox[{"order", "/", "2"}], "]"}], "-", 
          RowBox[{"\[Omega]", "[", 
           RowBox[{
            RowBox[{"order", "/", "2"}], "-", "1"}], "]"}]}], "]"}]}], 
       "}"}]}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.7693857717187767`*^9, 3.769385783102839*^9}, {
   3.7693858689122047`*^9, 3.7693858706197233`*^9}, 3.769386252214657*^9, {
   3.769386430484128*^9, 3.76938643085435*^9}, {3.769386620389969*^9, 
   3.769386625808708*^9}, {3.769386756178081*^9, 3.7693867598771667`*^9}, {
   3.769386960222858*^9, 3.7693869623350267`*^9}, {3.769387077685165*^9, 
   3.769387135589114*^9}, 3.769652435243846*^9, 3.769652555505849*^9, {
   3.7696526001471767`*^9, 3.769652600901835*^9}, {3.769652644922797*^9, 
   3.769652680833933*^9}, 3.769652718185255*^9, {3.769652770520817*^9, 
   3.7696528545036163`*^9}, {3.7696529058267717`*^9, 
   3.7696530376685343`*^9}, {3.769653074615808*^9, 3.769653122900111*^9}, {
   3.769653219921811*^9, 3.769653291023242*^9}, {3.769653321207387*^9, 
   3.7696533216788273`*^9}, {3.7696533709793167`*^9, 3.76965338004648*^9}, {
   3.769653483100923*^9, 3.7696534844935093`*^9}, {3.769653982240046*^9, 
   3.769653990885642*^9}, {3.769654055779408*^9, 3.769654065194736*^9}, {
   3.7696543544724503`*^9, 3.769654386827862*^9}, {3.769654975956935*^9, 
   3.7696549860593243`*^9}, {3.7696623908505774`*^9, 3.769662447810165*^9}, {
   3.769662575951441*^9, 3.7696626242011013`*^9}, {3.7696643291738033`*^9, 
   3.769664331861639*^9}, {3.769664716056987*^9, 3.769664826601699*^9}, {
   3.769665029377146*^9, 3.769665032806518*^9}, 3.769665064049213*^9, {
   3.76966520159426*^9, 3.769665202594898*^9}, {3.769665237258584*^9, 
   3.769665325029014*^9}, 3.769665768437044*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"7ca43b9b-e2f1-40b1-9368-25c791b69c32"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "You can see that the order-50 evaluation is very quickly done and already \
quite good for the lowest overtone.\n",
 StyleBox["Note:", "Subsubsection",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox[" ", "Subsubsection"],
 StyleBox["You have to choose the precision parameter \
\[OpenCurlyDoubleQuote]prec\[CloseCurlyDoubleQuote] carefully to avoid \
cancellation of digits. \nI don\[CloseCurlyQuote]t have a systematic way to \
determine its best value...", "Subsubsection",
  FontColor->GrayLevel[0]]
}], "Subsection",
 CellChangeTimes->{{3.769653680919395*^9, 3.769653740377*^9}, {
   3.769654018558661*^9, 3.769654019045023*^9}, {3.769654731319648*^9, 
   3.769654738921929*^9}, 3.769654838882885*^9, {3.769662501292358*^9, 
   3.7696625020121317`*^9}, {3.7696627836384983`*^9, 3.769662877465293*^9}, {
   3.7696629251337433`*^9, 3.7696629627081137`*^9}, {3.769663024370976*^9, 
   3.769663064477379*^9}, 3.769665570666368*^9, 
   3.76990425202037*^9},ExpressionUUID->"059b0584-3107-40bb-9881-\
dfa55772d59d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ord", "=", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"{", 
     RowBox[{"n", ",", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"QNM", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", "2", ",", "n"}], "}"}], ",", "ord",
            ",", "100"}], "]"}], ",", "20"}], "]"}], "//", 
       "AbsoluteTiming"}]}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "4"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.769653262582034*^9, 3.769653307536528*^9}, {
  3.7696534912656507`*^9, 3.769653568980901*^9}, {3.7696543910229*^9, 
  3.769654396196774*^9}, {3.769654746142344*^9, 3.769654753031715*^9}, {
  3.769655310624502*^9, 3.76965532171879*^9}, {3.7696627673284597`*^9, 
  3.769662771375656*^9}, {3.7696648722088118`*^9, 3.769664877978819*^9}, {
  3.769664921338512*^9, 3.769664929606436*^9}, {3.769665572782483*^9, 
  3.769665703241948*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"2c1f8942-56c0-463f-9311-4f181d50391b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Even to order-200, the evaluation is done in ten minutes on my iMac with \
Intel Core i7 (4 cores, 4.2GHz).\
\>", "Subsection",
 CellChangeTimes->{{3.769653812277678*^9, 3.7696538722862883`*^9}, {
   3.7696539563708363`*^9, 3.769653958313332*^9}, {3.769654790574092*^9, 
   3.7696548355852947`*^9}, {3.769655261113844*^9, 3.769655285137113*^9}, {
   3.769655587022388*^9, 3.769655597653399*^9}, {3.769663218313098*^9, 
   3.7696632208944883`*^9}, 
   3.769904266499775*^9},ExpressionUUID->"efacfbd7-cb27-47d5-863b-\
dc8f94550875"],

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{"QNM", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "2"}], ",", "2", ",", "0"}], "}"}], ",", "200", ",",
       "300"}], "]"}], ",", "30"}], "]"}], "//", "AbsoluteTiming"}]], "Input",\

 CellChangeTimes->{{3.769387149436734*^9, 3.769387152136217*^9}, {
  3.769387439917873*^9, 3.769387440230541*^9}, {3.769653752314621*^9, 
  3.7696537625395412`*^9}, {3.7696544806306887`*^9, 3.769654485669385*^9}, {
  3.769665439050611*^9, 3.769665440096242*^9}},
 CellLabel->
  "(Local) In[10]:=",ExpressionUUID->"5a35d423-40d5-43f5-aee4-f8b9bf5b00a6"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{713.25, 387},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.2 for Linux x86 (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2b5f182f-01b2-4d37-a197-412322dabacd"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 606, 11, 77, "Section",ExpressionUUID->"1d09d4ab-63f6-49bb-8694-8b41c66f29ba"],
Cell[CellGroupData[{
Cell[1211, 37, 486, 9, 79, "Subsection",ExpressionUUID->"bae8d14f-457c-44ba-9f83-bae1d4d2bca3"],
Cell[1700, 48, 152, 2, 22, "Input",ExpressionUUID->"3ea2f44f-ecde-4f00-bb7a-abc89e760b29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1889, 55, 628, 11, 59, "Subsection",ExpressionUUID->"cf5ff56b-470c-499d-b612-7be9f7b44e5b"],
Cell[2520, 68, 9777, 250, 499, "Input",ExpressionUUID->"7ca43b9b-e2f1-40b1-9368-25c791b69c32"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12334, 323, 1027, 19, 96, "Subsection",ExpressionUUID->"059b0584-3107-40bb-9881-dfa55772d59d"],
Cell[13364, 344, 1143, 27, 37, "Input",ExpressionUUID->"2c1f8942-56c0-463f-9311-4f181d50391b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14544, 376, 540, 10, 59, "Subsection",ExpressionUUID->"efacfbd7-cb27-47d5-863b-dc8f94550875"],
Cell[15087, 388, 644, 16, 32, "Input",ExpressionUUID->"5a35d423-40d5-43f5-aee4-f8b9bf5b00a6"]
}, Open  ]]
}, Open  ]]
}
]
*)

